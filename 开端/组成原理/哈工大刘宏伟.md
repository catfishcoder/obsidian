## 第一章 概览
## 第三章 总线
### 3.1 系统总线的基本概念
- 总线是连接多个部件的信息传输线，是各个部件共享的传输介质
- 总线上信息的方式有串行和并行两种
- 当多个部件与总线相连时，同一时刻只允许一个部件向总线发送信息，而多个部件可以同时从总线上接收相同的信息

### 3.2总线的分类

1. **片内总线**：芯片内部的中心
2. **系统总线**：各个部件之间的信息传输线，分为数据总线、地址总线、控制总线
	1. **数据总线**：传输数据信息，双向传输总线
	2. **地址总线**：用来指出数据总线上的源数据或者目的数据在主存单元或者I/O设备上的地址，地址总线是单向传输的
	3. **控制总线**：控制各个部件对总线的使用权，例如时钟、总线请求、总线允许、中断请求、中断响应、存储器读、存储器写等
3. **通信总线**：计算机系统之间、计算机系统与其他系统之间的通信 
### 3.3 总线特性及性能指标
1. **总线特性**：
	1. 机械特性：尺寸、形状、针脚数、排列顺序
	2. 电气特性：传输方向、有效电平范围
	3. 功能特性：每根传输线的功能，地址、数据、控制
	4. 时间特性：时序
2. **总线的性能指标**：
	1. 总线宽度：数据线的根数
	2. 标准传输率：每秒传输的最大字节数（MBps）
	3. 时钟同步/异步：同步、不同步
	4. 总线复用：地址线与数据线的复用
	5. 信号线数：地址线、数据线和控制线的总和
	6. 总线控制方式：突发、自动、仲裁、逻辑、计数
	7. 其他：负载能力
3. **总线标准**：
	1. 图3.4
### 3.4 总线结构
总线结构的分类
	- **单总线结构**：所有部件公用一条系统总线
	- **双总线结构**：除了所有部件公用的I/O总线外，CPU和主存之间多了一条存储总线
	- **三总线结构**：CPU和主存之间的局部总线、高速设备之间的高速总线、拓展设备之间的拓展总线
	- **四总线结构**：在CPU和主存之间加了一个cache/桥，主存通过系统总线连接到cache，cpu和cache之间通过局部总线相连，cache连接高速总线，高速总线与拓展总线相连

### 3.5 总线控制（重点）
#### 3.5.1 总线判优
> 总线的上各种设备按其对总线是否有控制能力分为：主设备和从设备。主设备对总线有控制权，从设备响应主设备发出的控制指令，如果有多个主设备要使用总线，就需要由总线控制器进行判优、仲裁。
> 主从设备是相对而言的，发出命令的设备叫主设备、接收命令的叫从设备

1. **链式查询**：
	1. 三根总线控制线（BS总线忙、BR总线请求、BG总线同意）。主设备发出BR总线请求信号，总线控制部件判断BS总线忙信号是否为真，如果非真，总线控制器就会发出BG总线同意信号，其中总线同意信号是串行的从一个I/O接口到下一个I/O接口，如果BG到达的接口有总线请求，BG信号就不再往下传，意味着该接口获得了总线使用权，并建立BS总线忙信号，表示它占用了总线
	2. 优缺点：，距离总线控制器的设备优先级较高只需要少数几根线就能按一定有限次序实现总线控制，容易扩充设备，但是优先级低的设备很难获得请求，对电路的故障很敏感
2. **计数器定时查询**：
	1. 控制总线为（BS总线忙、BR总线请求，设备地址总线）。总线控制器在收到设备发出的BR信号后，在总线未被使用的情况下，总线控制器中的计数器开始计数，并向各设备发出一组地址信号，注意这个过程，总线控制器是按照设备优先级依次向各个设备发出地址信号，如果设备地址不匹配，那么计数器加一继续匹配，如果某个设备的地址和总线控制器发出的地址信号相同，那么该设备就获得了总线控制权
	2. 这种方式中，设备的优先级是可以可以修改的，计数器的起始位置也是可以修改的
3. **独立请求方式**：
	1. 每个设备都有两条控制总线（BR总线请求，BG总线同意）与总线控制器相连
	2. 在总线控制器内部有一个排队器确定各设备的优先级
#### 3.5.2 总线通信控制

> 众多设备共享总线，在通信时间上则是按照分时方式来进行处理，即按照获得总线的先后顺序分时占用总线，

- 完成依次总线操作的时间称为总线周期，分为4个阶段：
	1. **申请分配阶段**：由需要使用总线的主模块提出申请，经总线仲裁机构决定下一个传输周期的总线使用权授予某一申请者
	2. **寻址阶段**：取得了使用权的主模块通过总线发出本次要访问的从模块的地址和有关指令，启动本次传输的从模块
	3. **传数阶段**：主模块和从模块进行数据交换
	4. **结束阶段**：主模块的有关信息从总线上撤出，让出总线使用权
- 总线通信控制主要解决通信双方如何获知传输开始和传输结束，以及通信双方如何协调配合，分为四种方式：
	1. **同步通信**：由统一时标控制数据传送
		1. 同步式数据输入
			1. ![同步式数据输入传输](https://s6.jpg.cm/2021/12/02/LWOsoD.png)
			2. 通过时钟脉冲的高低电平来控制各个步骤的开始结束点
				1. 在t1的上升沿主模块发出地址、在t2的上升沿主模块发出读命令、从模块在t3的上升沿到来之前将所需数据发送到数据总线上，主模块在t3周期内读入数据、t4主模块撤销读命令，从模块撤销数据，释放总线
		2. 同步式数据输出
			1. ![同步式数据输出](https://s6.jpg.cm/2021/12/02/LWOkV6.png)
			2. 在t1的上升沿主模块发地址、在t1的下降沿沿发送数据到总线、在t2的上升沿发出写命令，从模块收到命令后，在指定的周期内将数据总线上的数据写到地址总线所指定的单元中、t4主模块撤销写命令和数据 
		3. 优缺点：模块之间的配合简单、但是对不同速度的部件而言，必须按照最慢速度的部件设置公共时标
	2. **异步通信**：采用==应答方式==，没有公共时钟标准，分为不互锁、半互锁、全互锁三种类型
		1. ![总线异步通信](https://s6.jpg.cm/2021/12/02/LWZnu4.th.png)
		2. 不互锁方式：主模块发出请求信号，从模块收到请求信号后进行应答，但是主模块不必等待从模块的应答信号，在一定的周期之后就撤销请求信号，从模块也在一定周期之后撤销应答信号
		3. 半互锁方式：主模块发出请求信号，在接收到从模块的应答信号后才撤销请求信号，而从模块不必等待主模块撤销请求信号，在一段时间以后自动撤销应答信号
		4. 全互锁方式：主模块发出请求信号，在接收到从模块的应答信号之后撤销请求，从模块发出应答信号，必须在主模块撤销请求后才能撤销应答信号
	3. **半同步通信**：同步、异步结合
		1. ![半同步通信](https://gitee.com/zyanjun/pictures/raw/master/ComputerOrganization/%E6%80%BB%E7%BA%BF%E5%8D%8A%E5%90%8C%E6%AD%A5%E9%80%9A%E4%BF%A1.png)
		2. 同步：所有的地址、数据、命令的发出时间都在时钟周期的前沿开始、而接收方都在时钟周期的的后沿时刻进行判断识别
		3. 异步：增加了一条（wait）相应信号线，采用插入时钟周期的措施来协调通信双方的配合问题
		4. t1的上升沿主模块发出地址、t2的上升沿主模块发出读命令、倘若在t3周期内从模块无法提供数据，就会给WAIT一个低电平信号，主模块在t3周期到来前测得WAIT为低电平就会等待一个时钟周期，直到WAIT为高电平，主模块就会把下一个时钟周期当做t3，然后获得数据、t4结束传输
	4. **分离式通信**：
		1. 第一个周期：A模块获得总线使用权收后发出地址和命令，发送完成之后放弃总线使用权
		2. 第二个周期：B模块收到A模块的信号后，经过一定时间的处理，然后申请总线使用权，发出地址和数据


## 第四章 存储器
### 1. 主存储器
### 2. 高速缓冲存储器
### 3. 辅助存储器